{"version":3,"file":"main-hofcEWNc.js","sources":["../../src/index/index.js"],"sourcesContent":["import { Configurator } from '@lib/gltfDisplay'\r\n\r\nmain()\r\n\r\nfunction main() {\r\n  const configurator = new Configurator()\r\n  configurator.setConf(getSearchParams())\r\n}\r\n\r\n// =================== searchParams input ===================\r\nfunction getSearchParams() {\r\n  const { href } = location\r\n  const { searchParams } = new URL(href)\r\n  const searchP = Object.fromEntries(searchParams.entries())\r\n\r\n  if (!searchP.src) {\r\n    const el = document.createElement('div')\r\n    el.innerText = '未指定glTF，请在url query串中添加model参数！'\r\n    el.style.position = 'fixed'\r\n    el.style.top = 0\r\n    el.style.width = '100vw'\r\n    el.style.textAlign = 'center'\r\n    el.style.fontSize = '3rem'\r\n    el.style.color = 'red'\r\n    document.body.append(el)\r\n    return {}\r\n  }\r\n\r\n  searchP.enableCtrl = searchP.enableCtrl != null\r\n    ;['boxHelper', 'wireframe'].forEach((e) => {\r\n      if (searchP[e] != null) {\r\n        searchP[e] = true\r\n      }\r\n    })\r\n\r\n  searchP.rotate = str2Num(searchP.rotate, [-100, 100])\r\n  searchP.zoom = str2Num(searchP.zoom, [1e-4])\r\n  searchP.alpha = str2Num(searchP.alpha, [1e-4])\r\n  searchP.animationSpeed = str2Num(searchP.animationSpeed, [0, 3])\r\n\r\n  const [backgroundColorStr, backgroundOpacityStr] = searchP.bgColor?.split(/[,，]/) || []\r\n  const [bgColor, bgOpacity] = [str2Color(backgroundColorStr), str2Num(backgroundOpacityStr, [0, 1])]\r\n\r\n  const [lightColorStr, lightIntensityStr] = searchP.light?.split(/[,，]/) || []\r\n  searchP.light = undefined\r\n  const [lightColor, lightIntensity] = [str2Color(lightColorStr), str2Num(lightIntensityStr, [0], Boolean)]\r\n\r\n  const animations = searchP.animations?.split(/[,，]/)\r\n\r\n  const rst = JSON.parse(JSON.stringify({ ...searchP, bgColor, bgOpacity, lightColor, lightIntensity, animations }))\r\n  return rst\r\n}\r\n\r\n// =================== common utils ===================\r\n/**\r\n * 'fff' / 'ffffff' -> 0xffffff\r\n * @param {string} str 长度 3 or 6 的hex颜色字符串\r\n * @returns color 16进制hex色彩值\r\n */\r\nfunction str2Color(str) {\r\n  if (str?.startsWith('#') && [4, 7].includes(str.length)) return str\r\n  if (str?.length === 3) {\r\n    str = [...str].map(e => e.repeat(2)).join('')\r\n  }\r\n  let color\r\n  if (str?.length === 6) {\r\n    color = parseInt(str, 16)\r\n    if (Number.isNaN(color)) {\r\n      color = undefined\r\n    }\r\n  }\r\n  return color\r\n}\r\n\r\n/**\r\n * 字符串转数字: 非法字符串返回 undefined\r\n * @param {string} str \r\n * @param {[min: number, max: number]} minmax \r\n * @param {(str: string, num: string) => boolean} condition \r\n * @returns \r\n */\r\nfunction str2Num(str, [min, max] = [], condition) {\r\n  let num = +str\r\n  const z = !Number.isNaN(num) &&\r\n    num <= (max ?? num) &&\r\n    num >= (min ?? num) &&\r\n    !condition || condition?.(str, num)\r\n  if (z)\r\n    return num\r\n}\r\n"],"names":["main","Configurator","getSearchParams","href","searchParams","searchP","el","e","str2Num","backgroundColorStr","backgroundOpacityStr","_a","bgColor","bgOpacity","str2Color","lightColorStr","lightIntensityStr","_b","lightColor","lightIntensity","animations","_c","str","color","min","max","condition","num"],"mappings":"+CAEAA,EAAM,EAEN,SAASA,GAAO,CACO,IAAIC,EAAc,EAC1B,QAAQC,GAAiB,CACxC,CAGA,SAASA,GAAkB,WACzB,KAAM,CAAE,KAAAC,CAAI,EAAK,SACX,CAAE,aAAAC,CAAY,EAAK,IAAI,IAAID,CAAI,EAC/BE,EAAU,OAAO,YAAYD,EAAa,QAAO,CAAE,EAEzD,GAAI,CAACC,EAAQ,IAAK,CAChB,MAAMC,EAAK,SAAS,cAAc,KAAK,EACvC,OAAAA,EAAG,UAAY,kCACfA,EAAG,MAAM,SAAW,QACpBA,EAAG,MAAM,IAAM,EACfA,EAAG,MAAM,MAAQ,QACjBA,EAAG,MAAM,UAAY,SACrBA,EAAG,MAAM,SAAW,OACpBA,EAAG,MAAM,MAAQ,MACjB,SAAS,KAAK,OAAOA,CAAE,EAChB,CAAE,CACV,CAEDD,EAAQ,WAAaA,EAAQ,YAAc,KACxC,CAAC,YAAa,WAAW,EAAE,QAASE,GAAM,CACrCF,EAAQE,CAAC,GAAK,OAChBF,EAAQE,CAAC,EAAI,GAErB,CAAK,EAEHF,EAAQ,OAASG,EAAQH,EAAQ,OAAQ,CAAC,KAAM,GAAG,CAAC,EACpDA,EAAQ,KAAOG,EAAQH,EAAQ,KAAM,CAAC,IAAI,CAAC,EAC3CA,EAAQ,MAAQG,EAAQH,EAAQ,MAAO,CAAC,IAAI,CAAC,EAC7CA,EAAQ,eAAiBG,EAAQH,EAAQ,eAAgB,CAAC,EAAG,CAAC,CAAC,EAE/D,KAAM,CAACI,EAAoBC,CAAoB,IAAIC,EAAAN,EAAQ,UAAR,YAAAM,EAAiB,MAAM,UAAW,CAAE,EACjF,CAACC,EAASC,CAAS,EAAI,CAACC,EAAUL,CAAkB,EAAGD,EAAQE,EAAsB,CAAC,EAAG,CAAC,CAAC,CAAC,EAE5F,CAACK,EAAeC,CAAiB,IAAIC,EAAAZ,EAAQ,QAAR,YAAAY,EAAe,MAAM,UAAW,CAAE,EAC7EZ,EAAQ,MAAQ,OAChB,KAAM,CAACa,EAAYC,CAAc,EAAI,CAACL,EAAUC,CAAa,EAAGP,EAAQQ,EAAmB,CAAC,CAAC,EAAG,OAAO,CAAC,EAElGI,GAAaC,EAAAhB,EAAQ,aAAR,YAAAgB,EAAoB,MAAM,QAG7C,OADY,KAAK,MAAM,KAAK,UAAU,CAAE,GAAGhB,EAAS,QAAAO,EAAS,UAAAC,EAAW,WAAAK,EAAY,eAAAC,EAAgB,WAAAC,CAAY,CAAA,CAAC,CAEnH,CAQA,SAASN,EAAUQ,EAAK,CACtB,GAAIA,GAAA,MAAAA,EAAK,WAAW,MAAQ,CAAC,EAAG,CAAC,EAAE,SAASA,EAAI,MAAM,EAAG,OAAOA,GAC5DA,GAAA,YAAAA,EAAK,UAAW,IAClBA,EAAM,CAAC,GAAGA,CAAG,EAAE,IAAI,GAAK,EAAE,OAAO,CAAC,CAAC,EAAE,KAAK,EAAE,GAE9C,IAAIC,EACJ,OAAID,GAAA,YAAAA,EAAK,UAAW,IAClBC,EAAQ,SAASD,EAAK,EAAE,EACpB,OAAO,MAAMC,CAAK,IACpBA,EAAQ,SAGLA,CACT,CASA,SAASf,EAAQc,EAAK,CAACE,EAAKC,CAAG,EAAI,CAAE,EAAEC,EAAW,CAChD,IAAIC,EAAM,CAACL,EAKX,GAJU,CAAC,OAAO,MAAMK,CAAG,GACzBA,IAAQF,GAAOE,IACfA,IAAQH,GAAOG,IACf,CAACD,IAAaA,GAAA,YAAAA,EAAYJ,EAAKK,IAE/B,OAAOA,CACX"}